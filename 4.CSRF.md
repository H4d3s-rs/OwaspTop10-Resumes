
Cross-site Request Forgery or CSRF or also XSRF.... is a old web vulnerability and same being an "old" vuln still continue being dangerous, to exploit this flay we need three conditions...

1. A Relevant action on system
2. A cookie based session
3. No one un-predictable data on header


Let's think about the follow request..

```http
POST /email/change HTTP/1.1 
Host: vulnerable-website.com 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 30 
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE 

email=wiener@normal-user.com
```

here we have a relevant action because the request does a POST on a path /email/change that changes the email from the cookie owner, we can simply do this request or induce the user using some social engineering to take this action.

In fact this vulnerability are old, that means that we need some defenses like the SOP and CORS but we can also implement our self defense like a token non-predictable called **CSRF-TOKEN** (It need be well implemented otherwise we can still exploit it)

#### **CSRF Token**

We also can implement a non-predictable token with the request and a verification on back-end only to confirm, this action avoid manually the CSRF issue, because the attacker wouldn't to predict the token generate and the request will not be accepted and executed.


```html
<form name="change-email-form" action="/my-account/change-email" method="POST">   
    <label>Email</label> <input required type="email" name="email"
    value="example@normal-website.com"> 

    <input required type="hidden" name="csrf"
    value="50FaWgdOhi9M9wyna8taR1k3ODOR8d6u"> 

<button class='button' type='submit'> Update email </button> </form>
```


#### *HOW TO BYPASS*

Ever check the follow options

- The http Method (A system can validate a POST, but can't verificate a GET)
- The token Omittion (A system can validade the token, but doesn't validate if the token is away)
- The token exclusivity (A system can have a pool of token and not necessarally cares of which token pertences of a specific user.)

**NICE TOOL** :  https://github.com/0xInfection/XSRFProbe